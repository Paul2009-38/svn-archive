<project name="openstreetmap" default="dist" basedir=".">

<property name="src" location="src"/>
<property name="build" location="build"/>
<property name="dist" location="dist"/>
<property name="lib" location="lib"/>
<property name="icons" location="icons"/>
<property name="jsp" location="jsp"/>
<property name="edit" location="/var/lib/tomcat4/webapps/edit/"/>

<target name="init">
<tstamp/>
<mkdir dir="${build}"/>
<mkdir dir="${dist}"/>
</target>


<target name="compile" depends="init">
<javac srcdir="${src}"
  classpath="${lib}/openmap.jar:${lib}/xmlrpc-1.2-b1/xmlrpc-1.2-b1.jar:${lib}/xmlrpc-1.2-b1/xmlrpc-1.2-b1.jar:${lib}/xmlrpc.jar"
debug="true"
optimize="off"
destdir="${build}"
/>
</target>

<target name="dist" depends="compile">

<copy todir="${build}">
<fileset dir="${icons}"/>
</copy>

<jar destfile="${dist}/osm.jar" basedir="${build}"/>  
<copy file="${src}/index.html" tofile="${dist}/index.html"/>
<copy file="${lib}/openmap.jar" tofile="${dist}/openmap.jar"/>
<copy file="${lib}/xmlrpc-1.2-b1/xmlrpc-1.2-b1.jar" tofile="${dist}/xmlrpc-1.2-b1.jar"/>
<copy file="${lib}/xmlrpc-cvs/ws-xmlrpc/target/xmlrpc-2.0-a1-dev-applet.jar" tofile="${dist}/xmlrpc-applet.jar"/>
<copy file="${lib}/xmlrpc-cvs/ws-xmlrpc/lib/commons-codec-1.1.jar" tofile="${dist}/commons-codec-1.1.jar"/>
<copy file="${lib}/commons-fileupload-1.0/commons-fileupload-1.0.jar" tofile="${dist}/commons-fileupload-1.0.jar"/>

</target>


<target name="install" depends="dist">

<!--svn up && ant clean && ant dist && cp dist/*.jar /var/lib/tomcat4/webapps/api/WEB-INF/lib/ && cp -r jsp/* /var/lib/tomcat4/webapps/api/ -->
<copy todir="/var/lib/tomcat4/webapps/api/WEB-INF/lib/">
  <fileset dir="${dist}" casesensitive="yes">
    <include name="**/*.jar"/>
  </fileset>
</copy>

<copy todir="/var/lib/tomcat4/webapps/edit/WEB-INF/lib/">
  <fileset dir="${dist}" casesensitive="yes">
    <include name="**/*.jar"/>
  </fileset>
</copy>

<copy file="${jsp}/xml.jsp" tofile="/var/lib/tomcat4/webapps/api/xml.jsp" />

<copy file="${jsp}/newUser.jsp" tofile="${edit}/newUser.jsp" />
<copy file="${jsp}/uploadGPX.jsp" tofile="${edit}/uploadGPX.jsp" />
<copy file="${jsp}/login.jsp" tofile="${edit}/login.jsp" />
<copy file="${jsp}/applet.jsp" tofile="${edit}/applet.jsp" />
<copy file="${jsp}/logout.jsp" tofile="${edit}/logout.jsp" />
<copy file="${jsp}/editKeys.jsp" tofile="${edit}/editKeys.jsp" />
<copy file="${jsp}/viewMap.jsp" tofile="${edit}/viewMap.jsp" />
<copy file="${jsp}/viewMapImage.jsp" tofile="${edit}/viewMapImage.jsp" />
<!-- includes -->

<copy todir="/var/lib/tomcat4/webapps/edit/include/">
  <fileset dir="${jsp}/include/" casesensitive="yes">
    <include name="**/*.jsp"/>
  </fileset>
</copy>

<copy file="${jsp}/include/loginmessage.html" tofile="/var/lib/tomcat4/webapps/edit/include/loginmessage.html" />

<!-- images -->

<copy todir="/var/www/openstreetmap/images/">
  <fileset dir="html-images/">
    <include name="**/*.png"/>
  </fileset>
</copy>

<copy file="html-images/favicon.ico" tofile="/var/www/openstreetmap/favicon.ico" />

<copy file="icons/left.png" tofile="/var/www/openstreetmap/images/map_left.png" />
<copy file="icons/right.png" tofile="/var/www/openstreetmap/images/map_right.png" />
<copy file="icons/up.png" tofile="/var/www/openstreetmap/images/map_up.png" />
<copy file="icons/down.png" tofile="/var/www/openstreetmap/images/map_down.png" />
<copy file="icons/zoomin.png" tofile="/var/www/openstreetmap/images/map_zoomin.png" />
<copy file="icons/zoomout.png" tofile="/var/www/openstreetmap/images/map_zoomout.png" />
<!-- css -->

<copy file="css/style.css" tofile="/var/www/openstreetmap/css/style.css" />



<!--"osm.jar , openmap.jar , xmlrpc-applet.jar , commons-codec-1.1.jar"-->


<copy file="${dist}/osm.jar" tofile="/var/lib/tomcat4/webapps/edit/osm.jar" />
<copy file="${dist}/openmap.jar" tofile="/var/lib/tomcat4/webapps/edit/openmap.jar" />
<copy file="${dist}/xmlrpc-applet.jar" tofile="/var/lib/tomcat4/webapps/edit/xmlrpc-applet.jar" />
<copy file="${dist}/commons-codec-1.1.jar" tofile="/var/lib/tomcat4/webapps/edit/commons-codec-1.1.jar" />


</target>


<target name="clean">
<delete dir="${build}"/>
<delete dir="${dist}"/>
</target>



</project>
